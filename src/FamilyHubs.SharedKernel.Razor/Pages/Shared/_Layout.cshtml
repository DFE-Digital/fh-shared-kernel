@using FamilyHubs.SharedKernel.Razor.FamilyHubsUi.Options
@* we could use IOptionsSnapshot for updates without downtime, but we probably don't want the overhead for something so central*@
@inject IOptions<FamilyHubsUiOptions> FamilyHubsUiOptions
@{
    var familyHubsUiOptions = FamilyHubsUiOptions.Value;
}

<!DOCTYPE html>
<html lang="en" class="govuk-template">
<head>
    <partial name="_Head.cshtml" model="familyHubsUiOptions"/>

    @*todo: probably include these in _head also*@
    <link rel="stylesheet" href="~/css/application.css" asp-append-version="true"/>
    <!--[if IE 8]>
        <link href="~/css/govuk-frontend-ie8-4.5.0.min.css" rel="stylesheet">
    <![endif]-->
</head>

<body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <partial name="_CookieBanner.cshtml" model="familyHubsUiOptions" />

    <a href="#main-content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

    <partial name="_Header.cshtml" model="familyHubsUiOptions" />

    <div class="govuk-width-container">
        <partial name="_PhaseBanner.cshtml" model="familyHubsUiOptions" />

        @await RenderSectionAsync("Back", required: false)

        <main class="govuk-main-wrapper custom-main" id="main-content" role="main">
            @RenderBody()
        </main>
    </div>

    <partial name="_Footer.cshtml" model="familyHubsUiOptions" />
    
@*todo: is it better to include the version number in the script,
which means after a new deployment, if the script hasn't changed, the user browsers can used their cached version,
    or use asp-append-version, which means that after a deployment browsers could refetch unnecessarily, *@

<script src="~/js/govuk-frontend-4.5.0.min.js"></script>
@*todo: include package scripts into app.js, or import it separately, like govuk?*@
@*if separately, will have to bundle and minify it*@
@*todo: task to copy to wwwroot? or pick up from rcl?*@
    <script src="~/js/familyhubs-frontend-1.0.9-alpha.min.js"></script>
    <script src="~/js/app.js" asp-append-version="true"></script>

    <script>
        //todo: initialize just the components we use
        window.GOVUKFrontend.initAll();
        window.FamilyHubsFrontend.initAll();
    </script>

    @await RenderSectionAsync("Scripts", required: false)

</body>
</html>